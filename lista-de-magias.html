<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta content="maximum-scale=1.0, initial-scale=1.0, width=device-width" name="viewport" />
    <link rel="icon" href="/imagens/favicon.png" />
    <script>
        var pageName = "lista-de-magias";
        var pageTitle = "Lista de Magias";
        var pageGroup = "listasMagias";

        document.write("<title>" + pageTitle + "- Aux.5e</title>");
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300;400;500;600;700&family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital@0;1&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/all.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"
        integrity="sha512-bnIvzh6FU75ZKxp0GXLH9bewza/OIw6dLVh9ICg0gogclmYGguQJWl8U30WpbsGTqbIiAwxTsbe76DErLq5EDQ=="
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
    <script src="/js/misc.js" type="text/javascript"></script>
    <script src="/js/jquery-ui.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.11.3/sc-2.0.5/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.11.3/sc-2.0.5/datatables.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $(".magia-hover").tooltip({
                track: true,
                open: function (event, ui) {
                    var userid = this.id;

                    $.ajax({
                        url: "/data/magias-popover.php",
                        type: "post",
                        data: {
                            userid: userid,
                        },
                        success: function (response) {
                            // Setting content option
                            $("#" + userid).tooltip("option", "content", response);
                        },
                    });
                },
            });

            $(".magia-hover").mouseout(function () {
                // re-initializing tooltip
                $(this).attr("title", "Carregando...");
                $(this).tooltip();
                $(".ui-helper-hidden-accessible").hide();
                //$('.srd-tooltip').hide();
            });
        });

        $(document).ready(function () {
            $(document).ready(function () {
                $("#table-lista-de-magias").DataTable({
                    responsive: true,
                    language: {
                        url: "/data/dataTables.ptbr.json",
                    },
                    pageLength: 25,
                    paging: true,
                    scroller: true
                });
            });
        });

        var popover = true;
        var getObj; //htmlspecialchars($_GET["nome"]);
    </script>
</head>

<!-- <?php
$conjuracao = true;
$popover = true;
$getObj = htmlspecialchars($_GET["nome"]);

if ($conjuracao == true) {
	$jsonUrl = file_get_contents('https://aux5e.github.io/data/magias.json');
	$magiasJson = json_decode($jsonUrl,true);
}-->

<body>
    <div data-include="header"></div>

    <div class="container">
        <div class="row">
            <div class="col-xl">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="https://aux5e.github.io/">Home</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            Lista de Magias
                        </li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <div class="container" style="padding-bottom: 40px">
        <div class="main-filter-container">
            <div class="main-filter">
                <ul class="main-list">
                    <li class="item all-items class all-classes spellListActive">
                        <div onclick="window.location='/lista-de-magias.html'">
                            <img src="/imagens/icon-magias-todos.png" class="img-fluid" />
                            <span>Todas</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/bardo.html'">
                            <img src="/imagens/icon-magias-bardo2.png" class="img-fluid" />
                            <span>Bardo</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classe">
                        <div onclick="window.location='/lista-de-magias/bruxo.html'">
                            <img src="/imagens/icon-magias-bruxo.png" class="img-fluid" />
                            <span>Bruxo</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/clerigo.html'">
                            <img src="/imagens/icon-magias-clerigo.png" class="img-fluid" />
                            <span>Clérigo</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/druida.html'">
                            <img src="/imagens/icon-magias-druida2.png" class="img-fluid" />
                            <span>Druida</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/feiticeiro.html'">
                            <img src="/imagens/icon-magias-feiticeiro.png" class="img-fluid" />
                            <span>Feiticeiro</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/guardiao.html'">
                            <img src="/imagens/icon-magias-guardiao.png" class="img-fluid" />
                            <span>Guardião</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/ladino.html'">
                            <img src="/imagens/icon-magias-ladino.png" class="img-fluid" />
                            <span>Ladino</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/mago.html'">
                            <img src="/imagens/icon-magias-mago.png" class="img-fluid" />
                            <span>Mago</span>
                        </div>
                    </li>
                    <li class="item all-items class all-classes">
                        <div onclick="window.location='/lista-de-magias/paladino.html'">
                            <img src="/imagens/icon-magias-paladino.png" class="img-fluid" />
                            <span>Paladino</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div id="lista-de-magias" class="container">
        <h1 class="titulo-detalhes" style="margin-bottom: 22px">
            Lista de Magias
        </h1>

        <table id="table-lista-de-magias" class="display table table-bordered table-striped"
            style="font-size: 0.9em; margin-bottom: 35px">
            <thead>
                <tr>
                    <th scope="col" class="text-center align-middle" style="max-width: 60px;">Círculo</th>
                    <th scope="col" class="align-middle" style="min-width: 160px;">Nome</th>
                    <th scope="col" class="align-middle">Em Inglês</th>
                    <th scope="col" class="align-middle">Duração</th>
                    <th scope="col" class="align-middle">Alcance</th>
                    <th scope="col" class="text-center align-middle" style="max-width: 60px;">Fonte</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script>
        function loadIntoTable(url, table) {
            const tableBody = table.querySelector("tbody");
            
            $.getJSON(url, function (magias) {
                const magiasValues = Object.keys(magias.data);
                const siteUrl = 'https://aux5e.github.io';
                const magiasArray = Object.values(magias.data);
                const magiasLenght = Object.keys(magias.data).length;

                // Limpa o corpo da tabela
                // tableBody.innerHTML = "";

                // Popular o corpo da tabela
                var r = new Array(), j = -1;
                for (var row = 0; row < magiasLenght; row++) {
                    r[++j] = '<tr onclick=';
                    r[++j] = 'window.location="';
                    r[++j] = siteUrl;
                    r[++j] = '/magias.html?nome=';
                    r[++j] = magiasValues[row];
                    r[++j] = '"><th scope="row" class="text-center align-middle magiaCirculoCol">';
                    if (magiasArray[row].circulo == 0) {
                        r[++j] = '<span style="visibility:hidden;">0</span>Truque<span style="visibility:hidden;">0</span>';
                    }
                    else if (magiasArray[row].circulo > 0) {
                        r[++j] = magiasArray[row].circulo;
                        r[++j] = 'º';
                    }
                    r[++j] = '</th>';
                    r[++j] = '<td><div class="magiaNomeRow1">';
                    r[++j] = magiasArray[row].nome;
                    if (magiasArray[row].concentracao == true) {
                        r[++j] = '<span class="concentSpan"></span>';
                    }
                    r[++j] = '</div><div class="magiaNomeRow2">';
                    r[++j] = magiasArray[row].escola + ' • ' + magiasArray[row].componentes;
                    r[++j] = '</div></td>';
                    r[++j] = '<td class="align-middle magiaInglesCol">';
                    r[++j] = magiasArray[row].nome_ingles;
                    r[++j] = '</td><td class="align-middle magiaOutrasCol">';
                    r[++j] = magiasArray[row].duracao;
                    r[++j] = '</td><td class="align-middle magiaOutrasCol">'
                    r[++j] = magiasArray[row].alcance;
                    r[++j] = '</td><td class="text-center align-middle magiaOutrasCol">'
                    r[++j] = magiasArray[row].fonte;
                    r[++j] = '</td></tr>';
                }
                $(tableBody).html(r.join(''));
            });
        }

        loadIntoTable("/data/magias.json", document.getElementById("table-lista-de-magias"));
    </script>

    <div data-include="footer"></div>